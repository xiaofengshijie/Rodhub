local screenGui = Instance.new("ScreenGui")
screenGui.Name = "Rodhub"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0.7, 0, 0.7, 0)
mainFrame.Position = UDim2.new(0.15, 0, 0.15, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Name = "Title"
title.Size = UDim2.new(1, 0, 0.2, 0)
title.Position = UDim2.new(0, 0, 0, 0)
title.Text = "Rodhub"
title.Font = Enum.Font.GothamBold
title.TextSize = 28
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
title.BorderSizePixel = 0
title.Parent = mainFrame

local flyButton = Instance.new("TextButton")
flyButton.Name = "FlyButton"
flyButton.Size = UDim2.new(0.8, 0, 0.2, 0)
flyButton.Position = UDim2.new(0.1, 0, 0.4, 0)
flyButton.Text = "Toggle Fly"
flyButton.Font = Enum.Font.Gotham
flyButton.TextSize = 20
flyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
flyButton.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
flyButton.BorderSizePixel = 0
flyButton.Parent = mainFrame

local noclipButton = Instance.new("TextButton")
noclipButton.Name = "NoclipButton"
noclipButton.Size = UDim2.new(0.8, 0, 0.2, 0)
noclipButton.Position = UDim2.new(0.1, 0, 0.6, 0)
noclipButton.Text = "Toggle Noclip"
noclipButton.Font = Enum.Font.Gotham
noclipButton.TextSize = 20
noclipButton.TextColor3 = Color3.fromRGB(255, 255, 255)
noclipButton.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
noclipButton.BorderSizePixel = 0
noclipButton.Parent = mainFrame

local speedTextBox = Instance.new("TextBox")
speedTextBox.Name = "SpeedTextBox"
speedTextBox.Size = UDim2.new(0.8, 0, 0.2, 0)
speedTextBox.Position = UDim2.new(0.1, 0, 0.8, 0)
speedTextBox.Font = Enum.Font.Gotham
speedTextBox.TextSize = 20
speedTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
speedTextBox.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
speedTextBox.BorderSizePixel = 0
speedTextBox.PlaceholderText = "Enter speed (16-75)"
speedTextBox.Parent = mainFrame

local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0.8, 0, 0.2, 0)
toggleButton.Position = UDim2.new(0.1, 0, 0.9, 0)
toggleButton.Text = "Toggle UI"
toggleButton.Font = Enum.Font.Gotham
toggleButton.TextSize = 20
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
toggleButton.BorderSizePixel = 0
toggleButton.Parent = mainFrame

local speed = 16

local function updateSpeed(value)
    local speed = tonumber(value) or 16
    speed = math.clamp(speed, 16, 75)
    speedTextBox.Text = tostring(speed)
end

updateSpeed(speed)

speedTextBox.FocusLost:Connect(function()
    updateSpeed(speedTextBox.Text)
end)

local isUIVisible = true
toggleButton.MouseButton1Click:Connect(function()
    isUIVisible = not isUIVisible
    mainFrame.Visible = isUIVisible
end)

local dragging = false
local dragInput, mousePos, framePos

local function update(input)
    local delta = input.Position - mousePos
    mainFrame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
end

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        mousePos = input.Position
        framePos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

mainFrame.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        update(input)
    end
end)

local flyEnabled = false
local flySpeed = 0.1
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

local function onFlyButtonClicked()
    flyEnabled = not flyEnabled
    if flyEnabled then
        flyButton.Text = "Disable Fly"
        local function flyLoop()
            if not flyEnabled then return end
            local moveVector = Vector3.new()
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.W) then
                moveVector = moveVector + rootPart.CFrame.LookVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.S) then
                moveVector = moveVector - rootPart.CFrame.LookVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.A) then
                moveVector = moveVector - rootPart.CFrame.RightVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.D) then
                moveVector = moveVector + rootPart.CFrame.RightVector
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.Space) then
                moveVector = moveVector + Vector3.new(0, 1, 0)
            end
            if game:GetService("UserInputService"):IsKeyDown(Enum.KeyCode.LeftShift) then
                moveVector = moveVector - Vector3.new(0, 1, 0)
            end
            rootPart.Velocity = moveVector * speed
            wait()
            flyLoop()
        end
        flyLoop()
    else
        flyButton.Text = "Enable Fly"
        rootPart.Velocity = Vector3.new(0, 0, 0)
    end
end

flyButton.MouseButton1Click:Connect(onFlyButtonClicked)

local noclipEnabled = false

local function onNoclipButtonClicked()
    noclipEnabled = not noclipEnabled
    if noclipEnabled then
        noclipButton.Text = "Disable Noclip"
        local function noclipLoop()
            if not noclipEnabled then return end
            for _, part in ipairs(character:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
            wait()
            noclipLoop()
        end
        noclipLoop()
    else
        noclipButton.Text = "Enable Noclip"
        for _, part in ipairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

noclipButton.MouseButton1Click:Connect(onNoclipButtonClicked)

local VisualsTab = Window:MakeTab({
    Name = "透视",
    Icon = "rbxassetid://4483345998",
    PremiumOnly = false
})

local CF = CFrame.new
local LatestRoom = game:GetService("ReplicatedStorage").GameData.LatestRoom
local ChaseStart = game:GetService("ReplicatedStorage").GameData.ChaseStart

local KeyChams = {}
VisualsTab:AddToggle({
    Name = "钥匙透视",
    Default = false,
    Flag = "KeyToggle",
    Save = true,
    Callback = function(Value)
        for _,v in pairs(KeyChams) do
            v.Enabled = Value
            if not Value then v:Destroy() end
        end
    end    
})

local function ApplyKeyChams(inst)
    if not inst or not inst:IsA("BasePart") then return nil end
    local Cham = Instance.new("Highlight")
    Cham.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    Cham.FillColor = Color3.new(0.98, 0.67, 0)
    Cham.FillTransparency = 0.5
    Cham.OutlineColor = Color3.new(0.79, 0.79, 0.79)
    Cham.Parent = game:GetService("CoreGui")
    Cham.Adornee = inst
    Cham.Enabled = OrionLib.Flags["KeyToggle"].Value
    Cham:GetPropertyChangedSignal("Enabled"):Connect(function()
        if not Cham.Enabled then Cham:Destroy() end
    end)
    return Cham
end

local KeyCoroutine = coroutine.create(function()
    workspace.CurrentRooms.DescendantAdded:Connect(function(inst)
        if inst and inst:IsA("BasePart") and inst.Name == "KeyObtain" then
            table.insert(KeyChams, ApplyKeyChams(inst))
        end
    end)
end)
coroutine.resume(KeyCoroutine)
