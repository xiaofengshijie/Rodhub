local repo = "https://raw.githubusercontent.com/mstudio45/LinoriaLib/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()
local ThemeManager = loadstring(game:HttpGet(repo .. "addons/ThemeManager.lua"))()
local SaveManager = loadstring(game:HttpGet(repo .. "addons/SaveManager.lua"))()

local Options = Library.Options
local Toggles = Library.Toggles

Library.ForceCheckbox = false
Library.ShowToggleFrameInKeybinds = true

-- 初始化主窗口（初始时隐藏）
local Window = Library:CreateWindow({
    Title = "Rodhub（中文版）",
    Footer = "版本: 2.0",
    Icon = 95816097006870,
    NotifySide = "Right",
    ShowCustomCursor = true,
    Visible = false, -- 初始时隐藏窗口
})

-- 创建所有标签页
local VisualTab, gentab, chartab, survivortab, blatanttab, misctab = nil, nil, nil, nil, nil, nil

local function initializeTabs()
    VisualTab = Window:AddTab("视觉", "eye")
    gentab = Window:AddTab("生成器", "archive")
    chartab = Window:AddTab("杀手", "axe")
    survivortab = Window:AddTab("生存者", "key")
    blatanttab = Window:AddTab("显式", "laugh")
    misctab = Window:AddTab("其他", "meh")

-- 定义生成器标签页的左右分栏功能
    local leftGroup = gentab:AddLeftGroupbox("生成器功能")
    local rightGroup = gentab:AddRightGroupbox("高级功能")

    leftGroup:AddButton("瞬间解谜", function()
        instantsolvegen()
    end)

    leftGroup:AddButton("地狱模式瞬间解谜", function()
        instantsolvegenhell()
    end)

    leftGroup:AddButton("单次解谜", function()
        solvegen()
    end)

    rightGroup:AddToggle("自动解谜", {
        Default = false,
        Callback = function(state)
            autogen(state)
        end,
    })

    rightGroup:AddToggle("生成器高亮", {
        Default = false,
        Callback = function(state)
            toggleHighlightGen(state)
        end,
    })

    rightGroup:AddSlider("自动解谜延迟", {
        Default = 0.1,
        Min = 2.5,
        Max = 10,
        Rounding = 1,
        Suffix = "秒",
        Callback = function(value)
            delay = value
        end,
    })

    rightGroup:AddKeyPicker("执行当前解谜", {
        Default = "H",
        Callback = function()
            solvegen()
        end,
    })

    -- 视觉标签页功能
    local visualLeftGroup = VisualTab:AddLeftGroupbox("视觉功能")
    local visualRightGroup = VisualTab:AddRightGroupbox("高级视觉功能")

    visualLeftGroup:AddToggle("工具高亮", {
        Default = false,
        Callback = function(state)
            highlighttools(state)
        end,
    })

-- 视觉标签页功能
    local visualLeftGroup = VisualTab:AddLeftGroupbox("视觉功能")
    local visualRightGroup = VisualTab:AddRightGroupbox("高级视觉功能")

    visualLeftGroup:AddToggle("工具高亮", {
        Default = false,
        Callback = function(state)
            highlighttools(state)
        end,
    })

    visualLeftGroup:AddToggle("生存者高亮", {
        Default = false,
        Callback = function(state)
            survivorHighlighter(state)
        end,
    })

    visualRightGroup:AddToggle("杀手高亮", {
        Default = false,
        Callback = function(state)
            killerHighlighter(state)
        end,
    })

    visualRightGroup:AddToggle("自然腐化高亮", {
        Default = false,
        Callback = function(state)
            corruptnatureesp(state)
        end,
    })

    visualRightGroup:AddToggle("生存者工具高亮", {
        Default = false,
        Callback = function(state)
            survivorutilesp(state)
        end,
    })

    -- 杀手标签页功能
    local chartabLeftGroup = chartab:AddLeftGroupbox("杀手功能")
    chartabLeftGroup:AddButton("Hawk Tuah模式", function()
        hawktuahmode(true)
    end)

    -- 生存者标签页功能
    local survivortabLeftGroup = survivortab:AddLeftGroupbox("生存者功能")
    survivortabLeftGroup:AddButton("生存者功能1", function()
        -- 添加生存者相关功能
        print("执行生存者功能1")
    end)

    survivortabLeftGroup:AddButton("生存者功能2", function()
        -- 添加生存者相关功能
        print("执行生存者功能2")
    end)

    -- 显式标签页功能
    local blatanttabLeftGroup = blatanttab:AddLeftGroupbox("显式功能")
    blatanttabLeftGroup:AddButton("显式功能1", function()
        -- 添加显式相关功能
        print("执行显式功能1")
    end)

    blatanttabLeftGroup:AddButton("显式功能2", function()
        -- 添加显式相关功能
        print("执行显式功能2")
    end)

    -- 其他标签页功能
    local misctabLeftGroup = misctab:AddLeftGroupbox("其他功能")
    local misctabRightGroup = misctab:AddRightGroupbox("高级设置")

    misctabLeftGroup:AddButton("解锁客户端角色", function()
        unlockclientcharacters()
    end)

    misctabLeftGroup:AddToggle("隐藏玩家栏", {
        Default = false,
        Callback = function(state)
            togglehidebar(state)
        end,
    })

    misctabRightGroup:AddSlider("视野调整", {
        Default = 1,
        Min = 1,
        Max = 2,
        Rounding = 1,
        Suffix = ";",
        Callback = function(value)
            FOVmulti(value)
        end,
    })

    misctabRightGroup:AddKeyPicker("翻转", {
        Default = "~",
        Callback = function()
            flip()
        end,
    })

    -- 替换通知逻辑
    local function notify(title, content, duration)
        Library:Notify({
            Title = title,
            Description = content,
            Time = duration,
        })
    end
