local repo = "https://raw.githubusercontent.com/mstudio45/LinoriaLib/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()
local ThemeManager = loadstring(game:HttpGet(repo .. "addons/ThemeManager.lua"))()
local SaveManager = loadstring(game:HttpGet(repo .. "addons/SaveManager.lua"))()

local Options = Library.Options
local Toggles = Library.Toggles

Library.ForceCheckbox = false
Library.ShowToggleFrameInKeybinds = true

-- 初始化主窗口（初始时隐藏）
local Window = Library:CreateWindow({
    Title = "Rodhub（中文版）",
    Footer = "版本: 2.0",
    Icon = 95816097006870,
    NotifySide = "Right",
    ShowCustomCursor = true,
    Visible = false, -- 初始时隐藏窗口
})

-- 创建所有标签页
local VisualTab, gentab, chartab, survivortab, blatanttab, misctab = nil, nil, nil, nil, nil, nil

local function initializeTabs()
    VisualTab = Window:AddTab("视觉", "eye")
    gentab = Window:AddTab("生成器", "archive")
    chartab = Window:AddTab("杀手", "axe")
    survivortab = Window:AddTab("生存者", "key")
    blatanttab = Window:AddTab("显式", "laugh")
    misctab = Window:AddTab("其他", "meh")

-- 定义生成器标签页的左右分栏功能
    local leftGroup = gentab:AddLeftGroupbox("生成器功能")
    local rightGroup = gentab:AddRightGroupbox("高级功能")

    leftGroup:AddButton("瞬间解谜", function()
        instantsolvegen()
    end)

    leftGroup:AddButton("地狱模式瞬间解谜", function()
        instantsolvegenhell()
    end)

    leftGroup:AddButton("单次解谜", function()
        solvegen()
    end)

    rightGroup:AddToggle("自动解谜", {
        Default = false,
        Callback = function(state)
            autogen(state)
        end,
    })

    rightGroup:AddToggle("生成器高亮", {
        Default = false,
        Callback = function(state)
            toggleHighlightGen(state)
        end,
    })

    rightGroup:AddSlider("自动解谜延迟", {
        Default = 0.1,
        Min = 2.5,
        Max = 10,
        Rounding = 1,
        Suffix = "秒",
        Callback = function(value)
            delay = value
        end,
    })

    rightGroup:AddKeyPicker("执行当前解谜", {
        Default = "H",
        Callback = function()
            solvegen()
        end,
    })

    -- 视觉标签页功能
    local visualLeftGroup = VisualTab:AddLeftGroupbox("视觉功能")
    local visualRightGroup = VisualTab:AddRightGroupbox("高级视觉功能")

    visualLeftGroup:AddToggle("工具高亮", {
        Default = false,
        Callback = function(state)
            highlighttools(state)
        end,
    })
