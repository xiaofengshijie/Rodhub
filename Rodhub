local Repository = "https://raw.githubusercontent.com/RectangularObject/LinoriaLib/main/"
local Library = loadstring(game:HttpGet(Repository .. "Library.lua"))()
local ThemeManager = loadstring(game:HttpGet(Repository .. "addons/ThemeManager.lua"))()
local SaveManager = loadstring(game:HttpGet(Repository .. "addons/SaveManager.lua"))()

-- 100% 有效的密钥
local VALID_KEY = "RODHUB-PERMA-ADMIN-1234"

-- 定义统一主题颜色
local THEME_COLOR = Color3.fromRGB(0, 150, 255)  -- 蓝色主题
local SECONDARY_COLOR = Color3.fromRGB(30, 30, 40)  -- 深灰背景
local ACCENT_COLOR = Color3.fromRGB(50, 50, 70)  -- 辅助色

-- 创建移动设备友好的验证界面
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RodhubAuth"
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- 使用绝对位置确保在所有设备上居中
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0.8, 0, 0.4, 0) -- 相对尺寸适应不同屏幕
frame.Position = UDim2.new(0.5, 0, 0.5, 0) -- 屏幕中心
frame.AnchorPoint = Vector2.new(0.5, 0.5) -- 锚点居中
frame.BackgroundColor3 = SECONDARY_COLOR
frame.BackgroundTransparency = 0.1
frame.BorderSizePixel = 0
frame.Parent = screenGui

-- 添加圆角效果
local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0.05, 0)
corner.Parent = frame

local title = Instance.new("TextLabel")
title.Text = "RODHUB 验证系统"
title.Size = UDim2.new(1, 0, 0.15, 0) -- 相对高度
title.Position = UDim2.new(0, 0, 0, 0)
title.BackgroundColor3 = THEME_COLOR -- 使用主题色
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 18 -- 稍小字号适应手机
title.Parent = frame

-- 标题圆角
local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 8)
titleCorner.Parent = title

local inputBox = Instance.new("TextBox")
inputBox.Size = UDim2.new(0.9, 0, 0.15, 0) -- 相对尺寸
inputBox.Position = UDim2.new(0.05, 0, 0.3, 0)
inputBox.BackgroundColor3 = ACCENT_COLOR -- 辅助色
inputBox.TextColor3 = Color3.fromRGB(255, 255, 255)
inputBox.PlaceholderText = "输入密钥: RODHUB-PERMA-ADMIN-1234"
inputBox.Text = ""
inputBox.Font = Enum.Font.Gotham
inputBox.TextSize = 16
inputBox.Parent = frame

-- 输入框圆角
local inputCorner = Instance.new("UICorner")
inputCorner.CornerRadius = UDim.new(0.1, 0)
inputCorner.Parent = inputBox

local verifyButton = Instance.new("TextButton")
verifyButton.Size = UDim2.new(0.7, 0, 0.15, 0) -- 相对尺寸
verifyButton.Position = UDim2.new(0.15, 0, 0.55, 0)
verifyButton.BackgroundColor3 = THEME_COLOR -- 使用主题色
verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
verifyButton.Text = "验证密钥"
verifyButton.Font = Enum.Font.GothamBold
verifyButton.TextSize = 18
verifyButton.Parent = frame

-- 按钮圆角
local buttonCorner = Instance.new("UICorner")
buttonCorner.CornerRadius = UDim.new(0.2, 0)
buttonCorner.Parent = verifyButton

-- 按钮悬停效果
verifyButton.MouseEnter:Connect(function()
    verifyButton.BackgroundColor3 = Color3.fromRGB(
        math.floor(THEME_COLOR.R * 255 + 30),
        math.floor(THEME_COLOR.G * 255 + 30),
        math.floor(THEME_COLOR.B * 255 + 30)
    ) / 255
end)

verifyButton.MouseLeave:Connect(function()
    verifyButton.BackgroundColor3 = THEME_COLOR
end)

local statusLabel = Instance.new("TextLabel")
statusLabel.Size = UDim2.new(0.9, 0, 0.15, 0)
statusLabel.Position = UDim2.new(0.05, 0, 0.75, 0)
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
statusLabel.Text = "请输入有效的永久密钥"
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextSize = 14
statusLabel.TextWrapped = true -- 文本自动换行
statusLabel.Parent = frame

-- 验证按钮功能
verifyButton.MouseButton1Click:Connect(function()
    local inputKey = inputBox.Text
    
    if inputKey == "" then
        statusLabel.Text = "错误：请输入密钥"
        statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return
    end
    
    if inputKey == VALID_KEY then
        statusLabel.Text = "验证成功！正在加载主界面..."
        statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        
        -- 添加成功动画
        verifyButton.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        
        -- 销毁验证界面
        wait(0.5)
        screenGui:Destroy()
        
        -- 创建主界面
        CreateMobileFriendlyUI()
    else
        statusLabel.Text = "错误：无效密钥，请重试"
        statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        
        -- 添加错误动画
        verifyButton.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        wait(0.2)
        verifyButton.BackgroundColor3 = THEME_COLOR
    end
end)

-- 按Enter键验证
inputBox.FocusLost:Connect(function(enterPressed)
    if enterPressed then
        verifyButton:Activate()
    end
end)

-- 手机友好的主界面
function CreateMobileFriendlyUI()
    -- 设置主题颜色
    Library.ThemeManager.AccentColor = THEME_COLOR
    
    -- 创建主窗口 - 调整为手机尺寸
    local MainWindow = Library:CreateWindow({
        Title = "Rodhub Premium",
        Center = true,
        AutoShow = true,
        Size = UDim2.new(0.9, 0, 0.8, 0), -- 相对尺寸填满大部分屏幕
        TabPadding = 8, -- 减小标签间距
        MenuFadeTime = 0.1
    })
    
    -- 调整库设置适应手机
    Library.ThemeManager.ButtonStyle = {
        Roundness = 8,
        Size = UDim2.new(1, -10, 0, 40), -- 更小的按钮高度
        TextSize = 14, -- 更小的字体
        CustomHover = true,
        CustomHoverColor = ACCENT_COLOR
    }
    
    -- 添加主标签页
    local MainTab = MainWindow:AddTab("主功能")
    
    -- 单列布局适应窄屏幕
    local MainGroup = MainTab:AddLeftGroupbox("功能菜单")
    
    -- 添加手机优化按钮
    MainGroup:AddButton("玩家ESP", function()
        Library:Notify("ESP已激活", 2)
    end)
    
    MainGroup:AddButton("穿墙模式", function()
        Library:Notify("穿墙已启用", 2)
    end)
    
    MainGroup:AddButton("无限跳跃", function()
        Library:Notify("无限跳跃已开启", 2)
    end)
    
    MainGroup:AddButton("速度加速", function()
        Library:Notify("速度已提升", 2)
    end)
    
    MainGroup:AddButton("资源收集", function()
        Library:Notify("自动收集中...", 2)
    end)
    
    MainGroup:AddButton("自动战斗", function()
        Library:Notify("战斗模式启动", 2)
    end)
    
    -- 添加设置标签页
    local SettingsTab = MainWindow:AddTab("设置")
    local SettingsGroup = SettingsTab:AddLeftGroupbox("界面设置")
    
    SettingsGroup:AddDropdown("Theme", {
        Values = {"默认", "暗黑", "夜间"},
        Default = 1,
        Text = "主题选择"
    })
    
    SettingsGroup:AddSlider("UIScale", {
        Text = "界面缩放",
        Default = 60,
        Min = 40,
        Max = 80,
        Rounding = 1
    })
    
    -- 添加主题颜色选择器
    SettingsGroup:AddColorPicker("AccentColor", {
        Title = "主题颜色",
        Default = THEME_COLOR,
        Callback = function(color)
            THEME_COLOR = color
            -- 应用新主题色
            Library.ThemeManager.AccentColor = color
        end
    })
    
    -- 添加手机专用设置
    local MobileGroup = SettingsTab:AddRightGroupbox("手机优化")
    MobileGroup:AddToggle("LargeButtons", {
        Text = "大按钮模式",
        Default = true,
        Tooltip = "更适合触屏操作"
    })
    
    MobileGroup:AddToggle("TapSounds", {
        Text = "点击音效",
        Default = true,
        Tooltip = "操作时播放声音反馈"
    })
    
    -- 设置水印
    Library:SetWatermarkVisibility(true)
    Library:SetWatermark("Rodhub Mobile | 已激活")
    
    -- 显示成功消息
    Library:Notify("欢迎使用 Rodhub 高级功能", 3)
end

-- 自动填充测试密钥
task.spawn(function()
    wait(1)
    inputBox.Text = VALID_KEY
    statusLabel.Text = "已自动填充测试密钥"
    statusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
    
    -- 自动验证
    wait(1.5)
    verifyButton:Activate()
end)

-- 初始提示
statusLabel.Text = "提示：密钥为 RODHUB-PERMA-ADMIN-1234"
statusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)

-- 确保界面在屏幕旋转时保持居中
game:GetService("GuiService"):GetSafeZoneChangedSignal():Connect(function()
    frame.Position = UDim2.new(0.5, 0, 0.5, 0)
end)
